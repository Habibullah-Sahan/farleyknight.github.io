<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">

  <title><![CDATA[Farley's Ruby on Rails Blog]]></title>
  <link href="http://farleyknight.github.io/atom.xml" rel="self"/>
  <link href="http://farleyknight.github.io/"/>
  <updated>2013-09-08T10:06:25-04:00</updated>
  <id>http://farleyknight.github.io/</id>
  <author>
    <name><![CDATA[Farley Knight]]></name>
    
  </author>
  <generator uri="http://octopress.org/">Octopress</generator>

  
  <entry>
    <title type="html"><![CDATA[Customizing Devise views]]></title>
    <link href="http://farleyknight.github.io/customizing-devise-views/"/>
    <updated>2013-09-08T05:12:00-04:00</updated>
    <id>http://farleyknight.github.io/customizing-devise-views</id>
    <content type="html"><![CDATA[<h2>Customizing Devise Views</h2>

<p>If you need more control over how Devise works in your app, you&rsquo;re going to want to use their view generator as well. Run:</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class='bash'><span class='line'><span class="nv">$ </span>rails g devise:views
</span></code></pre></td></tr></table></div></figure>


<p>This adds a bunch of views under <code>app/views/</code>. The output should look something like this:</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
</pre></td><td class='code'><pre><code class='text'><span class='line'>invoke  Devise::Generators::SharedViewsGenerator
</span><span class='line'>create    app/views/devise/shared
</span><span class='line'>create    app/views/devise/shared/_links.erb
</span><span class='line'>invoke  form_for
</span><span class='line'>create    app/views/devise/confirmations
</span><span class='line'>create    app/views/devise/confirmations/new.html.erb
</span><span class='line'>create    app/views/devise/passwords
</span><span class='line'>create    app/views/devise/passwords/edit.html.erb
</span><span class='line'>create    app/views/devise/passwords/new.html.erb
</span><span class='line'>create    app/views/devise/registrations
</span><span class='line'>create    app/views/devise/registrations/edit.html.erb
</span><span class='line'>create    app/views/devise/registrations/new.html.erb
</span><span class='line'>create    app/views/devise/sessions
</span><span class='line'>create    app/views/devise/sessions/new.html.erb
</span><span class='line'>create    app/views/devise/unlocks
</span><span class='line'>create    app/views/devise/unlocks/new.html.erb
</span><span class='line'>invoke  erb
</span><span class='line'>create    app/views/devise/mailer
</span><span class='line'>create    app/views/devise/mailer/confirmation_instructions.html.erb
</span><span class='line'>create    app/views/devise/mailer/reset_password_instructions.html.erb
</span><span class='line'>create    app/views/devise/mailer/unlock_instructions.html.erb
</span></code></pre></td></tr></table></div></figure>


<h3>Customizing Devise with Twitter Bootstrap</h3>

<h3>Customizing user registration</h3>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[Getting started with RSpec]]></title>
    <link href="http://farleyknight.github.io/getting-started-with-rspec/"/>
    <updated>2013-09-07T14:41:00-04:00</updated>
    <id>http://farleyknight.github.io/getting-started-with-rspec</id>
    <content type="html"><![CDATA[<h1>What is RSpec?</h1>

<p><a href="http://rspec.info/">RSpec</a> is a Ruby gem for writing more elegant tests. It&rsquo;s known for being oriented for Behavior Driven Development.</p>

<h1>Installation</h1>

<h2>With a Gemfile</h2>

<p>If your project has Gemfile, add these lines to it:</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
</pre></td><td class='code'><pre><code class='ruby'><span class='line'><span class="n">group</span> <span class="ss">:test</span> <span class="k">do</span>
</span><span class='line'>  <span class="n">gem</span> <span class="s1">&#39;rspec&#39;</span>
</span><span class='line'><span class="k">end</span>
</span></code></pre></td></tr></table></div></figure>


<p>And then run</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class='bash'><span class='line'><span class="nv">$ </span>bundle
</span></code></pre></td></tr></table></div></figure>


<p>to install the gem.</p>

<h2>Without a Gemfile</h2>

<p>Install the <code>rspec</code> gem the old-fashioned way:</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class='bash'><span class='line'><span class="nv">$ </span>gem install rspec
</span></code></pre></td></tr></table></div></figure>


<h2>Initialization</h2>

<p>Next, you can initialize your project (can be a Rails app, Sinatra app, or even a Ruby gem) with the necessary <code>rspec</code> files:</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class='bash'><span class='line'><span class="nv">$ </span>rspec --init
</span></code></pre></td></tr></table></div></figure>


<p>This will add <code>spec/spec_helper.rb</code> and <code>.rspec</code> to your current directory.</p>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[Speed up development with guard]]></title>
    <link href="http://farleyknight.github.io/speed-up-development-with-guard/"/>
    <updated>2013-09-05T15:47:00-04:00</updated>
    <id>http://farleyknight.github.io/speed-up-development-with-guard</id>
    <content type="html"><![CDATA[
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[Rails admin panels with activeadmin]]></title>
    <link href="http://farleyknight.github.io/rails-admin-panels-with-activeadmin/"/>
    <updated>2013-09-05T15:22:00-04:00</updated>
    <id>http://farleyknight.github.io/rails-admin-panels-with-activeadmin</id>
    <content type="html"><![CDATA[<p>couldn&rsquo;t find file &lsquo;jquery-ui&rsquo;
  (in /home/umbrosus/.rvm/gems/ruby-1.9.3-p392@gancxadebebi/gems/activeadmin-0.5.1/app/assets/javascripts/active_admin/base.js:2)</p>

<p>The &ldquo;jquery-rails&rdquo; gem recently removed jQuery UI.</p>

<p><a href="https://github.com/rails/jquery-rails/commit/2fdcdb2633cbc6426d412c050200fc31d14b9a3b">https://github.com/rails/jquery-rails/commit/2fdcdb2633cbc6426d412c050200fc31d14b9a3b</a></p>

<p>They recommend using the jquery-ui-rails gem.</p>

<p>There is an active pull request (as of this writing) to add that gem as a dependency. However, the developers of ActiveAdmin have stated that they are &ldquo;locking it down until we officially drop support for Rails 3.0&rdquo;. The version they are locked to is jquery-rails &lt; 3.0.0.</p>

<p>In the meantime, just modify your Gemfile:</p>

<p>gem &ldquo;jquery-ui-rails&rdquo; Not recommended, see @Kevin&rsquo;s comment below</p>

<p>Or you can downgrade your version of jquery-rails:</p>

<p>gem &ldquo;jquery-rails&rdquo;, &ldquo;&lt; 3.0.0&rdquo;
Or you can pull from their Github master branch. They have applied a temporary fix.</p>

<p>gem &ldquo;activeadmin&rdquo;, github: &ldquo;gregbell/active_admin&rdquo;</p>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[You can't stay in GUI-land forever]]></title>
    <link href="http://farleyknight.github.io/you-cant-stay-in-gui-land-forever/"/>
    <updated>2013-09-05T09:59:00-04:00</updated>
    <id>http://farleyknight.github.io/you-cant-stay-in-gui-land-forever</id>
    <content type="html"><![CDATA[
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[git tools you should use]]></title>
    <link href="http://farleyknight.github.io/git-tools-you-should-use/"/>
    <updated>2013-09-05T09:59:00-04:00</updated>
    <id>http://farleyknight.github.io/git-tools-you-should-use</id>
    <content type="html"><![CDATA[<h2>tig</h2>

<h2>something for command line diffs</h2>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[Faster Rails boot times with zeus]]></title>
    <link href="http://farleyknight.github.io/faster-rails-boot-times-with-zeus/"/>
    <updated>2013-09-05T09:49:00-04:00</updated>
    <id>http://farleyknight.github.io/faster-rails-boot-times-with-zeus</id>
    <content type="html"><![CDATA[<p><a href="https://github.com/burke/zeus">zeus</a> gives you lightning fast Rails boot times. Starts a master Rails process &amp; spawns new processes for <code>rails console</code>, <code>rails server</code>, <code>rails generate</code>, etc.</p>

<h2>Install &amp; set up</h2>

<p>First off you&rsquo;ll want to install <code>zeus</code>.</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class='bash'><span class='line'><span class="nv">$ </span>gem install zeus
</span></code></pre></td></tr></table></div></figure>


<p>Notice that you <strong>don&rsquo;t</strong> need to add it to your <code>Gemfile</code>. It is ideally only run locally. Making it a project dependency can cause server maintenance problems down the line (see <a href="http://farleyknight.github.io/faster-boot-times-with-zeus/#common_zeus_problems">Common Zeus Problems</a> below). After installing, you can boot up <code>zeus</code> with the command:</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class='bash'><span class='line'><span class="nv">$ </span>zeus start
</span></code></pre></td></tr></table></div></figure>


<p>Here&rsquo;s what it looks like on my Ubuntu laptop:</p>

<p>[screenshot here]</p>

<h2>Common Zeus Tasks</h2>

<p>To run the Rails console:</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class='bash'><span class='line'><span class="nv">$ </span>zeus console
</span></code></pre></td></tr></table></div></figure>


<p>To run the Rails generator:</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class='bash'><span class='line'><span class="nv">$ </span>zeus generate model Book
</span></code></pre></td></tr></table></div></figure>


<p>To run the Rails sever:</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class='bash'><span class='line'><span class="nv">$ </span>zeus sever
</span></code></pre></td></tr></table></div></figure>


<h2>Common Zeus Problems</h2>

<p>While <code>zeus</code> is an awesome gem, getting it working without any issues can be a bit of a problem at times. Here&rsquo;s some common problems that can occur with <code>zeus</code> and Rails.</p>

<h3>zeus rspec</h3>

<p>If you&rsquo;re testing with RSpec. If you try <code>zeus rspec</code>, you&rsquo;ll likely get:</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class='bash'><span class='line'><span class="sb">`</span>spec_file?<span class="s1">&#39;: undefined method `match&#39;</span> <span class="k">for </span>nil:NilClass <span class="o">(</span>NoMethodError<span class="o">)</span>
</span></code></pre></td></tr></table></div></figure>


<p>Instead run <code>rspec</code>:</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class='bash'><span class='line'><span class="nv">$ </span>zeus <span class="nb">test </span>spec
</span></code></pre></td></tr></table></div></figure>


<h3>RSpec tests running twice</h3>

<p>After getting your rspec tests running, you&rsquo;ll probably notice that it&rsquo;s running them twice. <a href="https://github.com/burke/zeus/issues/180#issuecomment-12758345">The solution</a> is to remove the line</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class='ruby'><span class='line'><span class="nb">require</span> <span class="s1">&#39;rspec/autorun&#39;</span>
</span></code></pre></td></tr></table></div></figure>


<p>from your <code>spec/spec_helper.rb</code></p>

<h3>Running zeus on ARM (Chromebook or Raspberry Pi)</h3>

<p>While <code>zeus</code> is a great tool, it has it&rsquo;s limitations. It cannot be used on ARM chips, namely Chromebooks &amp; Raspberry Pi. If you&rsquo;re looking for this functionality on those machines (or other chips that might not be supported by <code>zeus</code>) I would suggest checking out <code>spring</code>, which is discussed below.</p>

<h3>By default, zeus can&rsquo;t handle assets</h3>

<p>Many of the <code>zeus rake ...</code> commands work out of the box, including <code>zeus rake db:migrate</code>. However, <code>rake</code> commands involving the asset pipeline do not work as well. For example, trying <code>zeus rake assets:precompile</code> will get you:</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
</pre></td><td class='code'><pre><code class='bash'><span class='line'><span class="nv">$ </span>zeus rake assets:clean
</span><span class='line'>
</span><span class='line'>/home/farleyknight/.rvm/rubies/ruby-1.9.3-p448/bin/ruby zeus <span class="nb">command</span>: rake assets:clean:all <span class="nv">RAILS_ENV</span><span class="o">=</span>development <span class="nv">RAILS_GROUPS</span><span class="o">=</span>assets
</span><span class='line'>/home/farleyknight/.rvm/rubies/ruby-1.9.3-p448/bin/ruby: No such file or directory -- zeus <span class="nb">command</span>: rake <span class="o">(</span>LoadError<span class="o">)</span>
</span><span class='line'>rake aborted!
</span><span class='line'>
</span><span class='line'>Command failed with status <span class="o">(</span>1<span class="o">)</span>: <span class="o">[</span>/home/farleyknight/.rvm/rubies/ruby-1.9.3-...<span class="o">]</span>
</span></code></pre></td></tr></table></div></figure>


<p>The problem is that zeus doesn&rsquo;t change the <code>ENV['RAILS_GROUP']</code> for <code>rake assets:precompile</code> to work.</p>

<p>The fix is as follows.</p>

<p>First, make sure you have the line in your current environment file:</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class='ruby'><span class='line'><span class="n">config</span><span class="o">.</span><span class="n">assets</span><span class="o">.</span><span class="n">initialize_on_precompile</span> <span class="o">=</span> <span class="kp">false</span>
</span></code></pre></td></tr></table></div></figure>


<p>Next run:</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class='bash'><span class='line'><span class="nv">$ </span>zeus init
</span></code></pre></td></tr></table></div></figure>


<p>It will create <code>zeus.json</code> and <code>custom_plan.rb</code>. Change your custom plan to match:</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
<span class='line-number'>25</span>
<span class='line-number'>26</span>
<span class='line-number'>27</span>
<span class='line-number'>28</span>
</pre></td><td class='code'><pre><code class='ruby'><span class='line'><span class="nb">require</span> <span class="s1">&#39;zeus/rails&#39;</span>
</span><span class='line'>
</span><span class='line'><span class="c1"># Usage: `zeus assets some:nested:task&#39;</span>
</span><span class='line'><span class="c1">#</span>
</span><span class='line'><span class="c1"># translates to</span>
</span><span class='line'><span class="c1">#</span>
</span><span class='line'><span class="c1"># `rake assets:some:nested:task`</span>
</span><span class='line'><span class="c1">#</span>
</span><span class='line'><span class="c1"># E.g.</span>
</span><span class='line'><span class="c1">#</span>
</span><span class='line'><span class="c1"># `zeus assets precompile`</span>
</span><span class='line'><span class="c1">#</span>
</span><span class='line'><span class="c1"># instead of `rake assets:precompile`</span>
</span><span class='line'>
</span><span class='line'><span class="k">class</span> <span class="nc">AssetsPlan</span> <span class="o">&lt;</span> <span class="ss">Zeus</span><span class="p">:</span><span class="ss">:Rails</span>
</span><span class='line'>  <span class="k">def</span> <span class="nf">assets_environment</span>
</span><span class='line'>    <span class="no">Bundler</span><span class="o">.</span><span class="n">require</span><span class="p">(</span><span class="ss">:development</span><span class="p">,</span> <span class="ss">:assets</span><span class="p">)</span>
</span><span class='line'>    <span class="o">::</span><span class="no">Rails</span><span class="o">.</span><span class="n">env</span> <span class="o">=</span> <span class="no">ENV</span><span class="o">[</span><span class="s1">&#39;RAILS_ENV&#39;</span><span class="o">]</span> <span class="o">=</span> <span class="s2">&quot;development&quot;</span>
</span><span class='line'>    <span class="no">ENV</span><span class="o">[</span><span class="s1">&#39;RAILS_GROUPS&#39;</span><span class="o">]</span> <span class="o">=</span> <span class="s2">&quot;assets&quot;</span>
</span><span class='line'>  <span class="k">end</span>
</span><span class='line'>
</span><span class='line'>  <span class="k">def</span> <span class="nf">assets</span>
</span><span class='line'>    <span class="no">ARGV</span><span class="o">.</span><span class="n">first</span><span class="o">.</span><span class="n">prepend</span> <span class="s2">&quot;assets:&quot;</span>
</span><span class='line'>    <span class="no">Rake</span><span class="o">.</span><span class="n">application</span><span class="o">.</span><span class="n">run</span>
</span><span class='line'>  <span class="k">end</span>
</span><span class='line'><span class="k">end</span>
</span><span class='line'>
</span><span class='line'><span class="no">Zeus</span><span class="o">.</span><span class="n">plan</span> <span class="o">=</span> <span class="no">AssetsPlan</span><span class="o">.</span><span class="n">new</span>
</span></code></pre></td></tr></table></div></figure>


<p>And change <code>zeus.json</code> to match:</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
<span class='line-number'>25</span>
<span class='line-number'>26</span>
</pre></td><td class='code'><pre><code class='json'><span class='line'><span class="p">{</span>
</span><span class='line'>  <span class="nt">&quot;command&quot;</span><span class="p">:</span> <span class="s2">&quot;ruby -rubygems -r./zeus_assets -eZeus.go&quot;</span><span class="p">,</span>
</span><span class='line'>  <span class="nt">&quot;plan&quot;</span><span class="p">:</span> <span class="p">{</span>
</span><span class='line'>    <span class="nt">&quot;boot&quot;</span><span class="p">:</span> <span class="p">{</span>
</span><span class='line'>      <span class="nt">&quot;default_bundle&quot;</span><span class="p">:</span> <span class="p">{</span>
</span><span class='line'>        <span class="nt">&quot;assets_environment&quot;</span><span class="p">:</span> <span class="p">{</span>
</span><span class='line'>          <span class="nt">&quot;assets&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;a&quot;</span><span class="p">]</span>
</span><span class='line'>        <span class="p">},</span>
</span><span class='line'>        <span class="nt">&quot;development_environment&quot;</span><span class="p">:</span> <span class="p">{</span>
</span><span class='line'>          <span class="nt">&quot;prerake&quot;</span><span class="p">:</span> <span class="p">{</span>
</span><span class='line'>            <span class="nt">&quot;rake&quot;</span><span class="p">:</span> <span class="p">[]</span>
</span><span class='line'>          <span class="p">},</span>
</span><span class='line'>          <span class="nt">&quot;runner&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;r&quot;</span><span class="p">],</span>
</span><span class='line'>          <span class="nt">&quot;console&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;c&quot;</span><span class="p">],</span>
</span><span class='line'>          <span class="nt">&quot;server&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;s&quot;</span><span class="p">],</span>
</span><span class='line'>          <span class="nt">&quot;generate&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;g&quot;</span><span class="p">],</span>
</span><span class='line'>          <span class="nt">&quot;destroy&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;d&quot;</span><span class="p">],</span>
</span><span class='line'>          <span class="nt">&quot;dbconsole&quot;</span><span class="p">:</span> <span class="p">[]</span>
</span><span class='line'>        <span class="p">},</span>
</span><span class='line'>        <span class="nt">&quot;test_environment&quot;</span><span class="p">:</span> <span class="p">{</span>
</span><span class='line'>          <span class="nt">&quot;test_helper&quot;</span><span class="p">:</span> <span class="p">{</span><span class="nt">&quot;test&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;rspec&quot;</span><span class="p">,</span> <span class="s2">&quot;testrb&quot;</span><span class="p">]}</span>
</span><span class='line'>        <span class="p">}</span>
</span><span class='line'>      <span class="p">}</span>
</span><span class='line'>    <span class="p">}</span>
</span><span class='line'>  <span class="p">}</span>
</span><span class='line'><span class="p">}</span>
</span></code></pre></td></tr></table></div></figure>


<p>This will add the command <code>zeus assets ...</code>, so for example <code>zeus assets clean</code> will run <code>rake assets:clean</code> and <code>zeus assets precompile</code> will run <code>rake assets:precompile</code> and so on.</p>

<p>If you&rsquo;re interested on how the <code>Zeus::Rails</code> plans work, <a href="https://github.com/burke/zeus/blob/master/docs/ruby/modifying.md">checkout the documentation</a> on the <a href="https://github.com/burke/zeus/">github repository</a>.</p>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[Devise Email Setup]]></title>
    <link href="http://farleyknight.github.io/devise-email-setup/"/>
    <updated>2013-09-02T14:43:00-04:00</updated>
    <id>http://farleyknight.github.io/devise-email-setup</id>
    <content type="html"><![CDATA[<h2>Basic Setup</h2>

<p>The most basic Devise email setup is to set configuration for <code>ActionMailer</code>, which is slightly different for <code>development</code> and <code>production</code> modes. However, for both modes you&rsquo;ll want to check out your <code>config/initializers/devise.rb</code> file and change the line that reads:</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class='ruby'><span class='line'><span class="n">config</span><span class="o">.</span><span class="n">mailer_sender</span> <span class="o">=</span> <span class="s2">&quot;please-change-me-at-config-initializers-devise@example.com&quot;</span>
</span></code></pre></td></tr></table></div></figure>


<p>To something a bit more sane, such as:</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class='ruby'><span class='line'><span class="n">config</span><span class="o">.</span><span class="n">mailer_sender</span> <span class="o">=</span> <span class="s2">&quot;support@mysite.com&quot;</span>
</span></code></pre></td></tr></table></div></figure>


<p>After setting this, all devise email will be sent as <code>support@mysite.com</code>.</p>

<h2>ActionMailer setup</h2>

<p>All of this information is available in detail on the <a href="http://guides.rubyonrails.org/action_mailer_basics.html#action-mailer-configuration">official ActionMailer guide page</a>. However, this document will get you started faster, with some reasonable defaults.</p>

<h3>ActionMailer in <code>development</code> with Gmail</h3>

<p>The best way to handle email in your <code>development</code> environment is with a throw-away Gmail account. I emphasize that it should be throw-away as we&rsquo;re including the email &amp; password directly in the config file. If you&rsquo;re application has serious security implications, it&rsquo;s best that you use <code>sendmail</code> to do email during development, or that you pass the email &amp; password via another configuration file that is not committed to your project (by ignoring it in <code>.gitignore</code>).</p>

<p>With that preface out of the way, in your <code>config/environments/development.rb</code> you&rsquo;ll want to have the following configuration:</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
</pre></td><td class='code'><pre><code class='ruby'><span class='line'><span class="n">config</span><span class="o">.</span><span class="n">action_mailer</span><span class="o">.</span><span class="n">default_url_options</span> <span class="o">=</span> <span class="p">{</span><span class="ss">:host</span> <span class="o">=&gt;</span> <span class="s1">&#39;localhost:3000&#39;</span><span class="p">}</span>
</span><span class='line'><span class="n">config</span><span class="o">.</span><span class="n">action_mailer</span><span class="o">.</span><span class="n">delivery_method</span>     <span class="o">=</span> <span class="ss">:smtp</span>
</span><span class='line'><span class="n">config</span><span class="o">.</span><span class="n">action_mailer</span><span class="o">.</span><span class="n">smtp_settings</span>       <span class="o">=</span> <span class="p">{</span>
</span><span class='line'>   <span class="ss">:tls</span>            <span class="o">=&gt;</span> <span class="kp">true</span><span class="p">,</span>
</span><span class='line'>   <span class="ss">:address</span>        <span class="o">=&gt;</span> <span class="s2">&quot;smtp.gmail.com&quot;</span><span class="p">,</span>
</span><span class='line'>   <span class="ss">:port</span>           <span class="o">=&gt;</span> <span class="mi">587</span><span class="p">,</span>
</span><span class='line'>   <span class="ss">:domain</span>         <span class="o">=&gt;</span> <span class="s2">&quot;gmail.com&quot;</span><span class="p">,</span>
</span><span class='line'>   <span class="ss">:authentication</span> <span class="o">=&gt;</span> <span class="ss">:login</span><span class="p">,</span>
</span><span class='line'>   <span class="ss">:user_name</span>      <span class="o">=&gt;</span> <span class="s2">&quot;[username]&quot;</span><span class="p">,</span>
</span><span class='line'>   <span class="ss">:password</span>       <span class="o">=&gt;</span> <span class="s2">&quot;[password]&quot;</span>
</span><span class='line'><span class="p">}</span>
</span></code></pre></td></tr></table></div></figure>


<p>You&rsquo;ll want to replace <code>[email]</code> and <code>[password]</code> with your Gmail email &amp; password.</p>

<p>You can see a working <a href="http://github.com/farleyknight/devise_email">example app here</a>.</p>

<h3>ActionMailer in <code>production</code></h3>

<p>Setting up ActionMailer in production requires a real domain name. So don&rsquo;t bother with this step until you&rsquo;ve registered one. I suggest <code>namecheap.com</code>. Assuming you&rsquo;ve just registered, if your domain name is <code>example.com</code>, go into your <code>config/environments/production.rb</code> and add the following lines:</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
</pre></td><td class='code'><pre><code class='ruby'><span class='line'><span class="n">config</span><span class="o">.</span><span class="n">action_mailer</span><span class="o">.</span><span class="n">default_url_options</span> <span class="o">=</span> <span class="p">{</span><span class="ss">:host</span> <span class="o">=&gt;</span> <span class="s1">&#39;example.com&#39;</span><span class="p">}</span>
</span><span class='line'><span class="n">config</span><span class="o">.</span><span class="n">action_mailer</span><span class="o">.</span><span class="n">delivery_method</span>     <span class="o">=</span> <span class="ss">:smtp</span>
</span><span class='line'><span class="n">config</span><span class="o">.</span><span class="n">action_mailer</span><span class="o">.</span><span class="n">smtp_settings</span>       <span class="o">=</span> <span class="p">{</span>
</span><span class='line'>  <span class="ss">:address</span> <span class="o">=&gt;</span> <span class="s2">&quot;127.0.0.1&quot;</span><span class="p">,</span>
</span><span class='line'>  <span class="ss">:port</span>    <span class="o">=&gt;</span> <span class="mi">25</span><span class="p">,</span>
</span><span class='line'>  <span class="ss">:domain</span>  <span class="o">=&gt;</span> <span class="s1">&#39;example.com&#39;</span>
</span><span class='line'><span class="p">}</span>
</span></code></pre></td></tr></table></div></figure>


<p>Afterwards, you&rsquo;ll want to set up a simple SMTP server on your web host. Run:</p>

<p><code>gem install mailcatcher</code></p>

<p>Will install the <a href="http://mailcatcher.me/">mailcatcher</a> gem.</p>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[Basic Web Security]]></title>
    <link href="http://farleyknight.github.io/basic-web-security/"/>
    <updated>2013-09-02T14:35:00-04:00</updated>
    <id>http://farleyknight.github.io/basic-web-security</id>
    <content type="html"><![CDATA[<h2>How to handle passwords</h2>

<p>You want to avoid passwords as much as possible when developing. This is not just a convenience measure, but also an engineering measure. Each human-memorized password will be another point of attack for your web server and web application. Whenever possible encrypted keys are preferable to passwords, as they tend to be much longer (and thus harder to brute-force), require no memorization, and can be locked away on thumbdrives or on the filesystem.</p>

<h3>Set up passwordless SSH</h3>

<p>If you&rsquo;ve got a web server which you can SSH into, you should immediately remove route around the need for passwords by running this command:</p>

<p><code>ssh-copy-id [myaccount]@[mysite]</code></p>

<p>If you run this command (replacing <code>[myaccount]</code> with your SSH login and <code>[mysite]</code> with your site&rsquo;s domain name), you&rsquo;ll be asked one more time to login with a password.</p>

<h3>Put passwords into config files, not in source code</h3>

<h3>Put passwords into a password manager. Don&rsquo;t bother memorizing them.</h3>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[Basic Devise Customization]]></title>
    <link href="http://farleyknight.github.io/basic-devise-customization/"/>
    <updated>2013-09-02T14:15:00-04:00</updated>
    <id>http://farleyknight.github.io/basic-devise-customization</id>
    <content type="html"><![CDATA[<p>Sometimes setting up Devise is just the start of your app, and you need more customization to provide a robust user experience. Here&rsquo;s some common Devise customizations that should take you even further along than the <a href="http://farleyknight.github.io/getting-started-with-devise/">basic Devise guide</a> I&rsquo;ve written before.</p>

<h2>Adding a Profile to your User model</h2>

<p>Let&rsquo;s say you&rsquo;re building a social networking site. You want to keep a clean separation between the users <em>account</em> (their email, password, account status, etc) from the user&rsquo;s <em>profile data</em> (first &amp; last name, avatar, location, relationship status, etc). The best way to handle this is to add another model for Profile, creating it alongside the User model during registration.</p>

<p>Here&rsquo;s how to customize the user model for exactly this use case.</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
</pre></td><td class='code'><pre><code class='ruby'><span class='line'><span class="k">class</span> <span class="nc">User</span> <span class="o">&lt;</span> <span class="ss">ActiveRecord</span><span class="p">:</span><span class="ss">:Base</span>
</span><span class='line'>  <span class="c1"># Include default devise modules. Others available are:</span>
</span><span class='line'>  <span class="c1"># :token_authenticatable, :confirmable,</span>
</span><span class='line'>  <span class="c1"># :lockable, :timeoutable and :omniauthable</span>
</span><span class='line'>  <span class="n">devise</span> <span class="ss">:database_authenticatable</span><span class="p">,</span> <span class="ss">:registerable</span><span class="p">,</span> <span class="ss">:recoverable</span><span class="p">,</span> <span class="ss">:rememberable</span><span class="p">,</span> <span class="ss">:trackable</span><span class="p">,</span> <span class="ss">:validatable</span>
</span><span class='line'>
</span><span class='line'>  <span class="n">has_one</span> <span class="ss">:profile</span>
</span><span class='line'>  <span class="n">accepts_nested_attributes_for</span> <span class="ss">:profile</span>
</span><span class='line'><span class="k">end</span>
</span></code></pre></td></tr></table></div></figure>




<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
</pre></td><td class='code'><pre><code class='ruby'><span class='line'><span class="k">class</span> <span class="nc">Profile</span> <span class="o">&lt;</span> <span class="ss">ActiveRecord</span><span class="p">:</span><span class="ss">:Base</span>
</span><span class='line'>  <span class="n">belongs_to</span> <span class="ss">:user</span>
</span><span class='line'>  <span class="n">validates</span> <span class="ss">:first_name</span><span class="p">,</span> <span class="ss">:last_name</span><span class="p">,</span> <span class="ss">:location</span><span class="p">,</span> <span class="ss">presence</span><span class="p">:</span> <span class="kp">true</span>
</span><span class='line'><span class="k">end</span>
</span></code></pre></td></tr></table></div></figure>


<p>Here&rsquo;s <a href="http://github.com/farleyknight/devise_profiles/">an example app</a> that shows how all of this fits together:</p>

<h2>Signing up with Facebook, Twitter, etc</h2>

<p>An often requested feature is to allow users to sign up via Facebook, Twitter, or other social network.</p>

<p>You&rsquo;ll need to add a few more gems to do this. You&rsquo;ll need to add to your Gemfile:</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
</pre></td><td class='code'><pre><code class='ruby'><span class='line'><span class="n">gem</span> <span class="s1">&#39;devise&#39;</span> <span class="c1"># Should already be in your Gemfile</span>
</span><span class='line'><span class="n">gem</span> <span class="s1">&#39;omniauth&#39;</span>
</span><span class='line'><span class="n">gem</span> <span class="s1">&#39;omniauth-facebook&#39;</span>
</span></code></pre></td></tr></table></div></figure>


<h3>Devise Facebook fast-track</h3>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class='ruby'><span class='line'><span class="n">rails</span> <span class="kp">new</span> <span class="n">my_website</span> <span class="o">-</span><span class="n">m</span> <span class="ss">https</span><span class="p">:</span><span class="sr">//</span><span class="n">raw</span><span class="o">.</span><span class="n">github</span><span class="o">.</span><span class="n">com</span><span class="o">/</span><span class="n">farleyknight</span><span class="o">/</span><span class="n">rails_templates</span><span class="o">/</span><span class="n">master</span><span class="o">/</span><span class="n">devise_facebook</span><span class="o">.</span><span class="n">rb</span>
</span></code></pre></td></tr></table></div></figure>


<p>[discuss facebook integration]</p>

<p>Here&rsquo;s <a href="http://github.com/farleyknight/devise_facebook/">an example app</a> that shows how all of this fits together.</p>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[Common Devise Problems]]></title>
    <link href="http://farleyknight.github.io/common-devise-problems/"/>
    <updated>2013-09-02T12:35:00-04:00</updated>
    <id>http://farleyknight.github.io/common-devise-problems</id>
    <content type="html"><![CDATA[<h2>No route matches [GET] &ldquo;/users/sign_out&rdquo;</h2>

<p>Say you&rsquo;ve got a logout partial that looks like this.</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
</pre></td><td class='code'><pre><code class='erb'><span class='line'><span class="x">&lt;div id=&quot;logout_link&quot;&gt;</span>
</span><span class='line'><span class="x">  </span><span class="cp">&lt;%</span> <span class="k">if</span> <span class="n">signed_in?</span> <span class="cp">%&gt;</span><span class="x"></span>
</span><span class='line'><span class="x">    </span><span class="cp">&lt;%=</span> <span class="n">link_to</span> <span class="s2">&quot;Logout&quot;</span><span class="p">,</span> <span class="n">destroy_user_session_path</span> <span class="cp">%&gt;</span><span class="x"></span>
</span><span class='line'><span class="x">  </span><span class="cp">&lt;%</span> <span class="k">end</span> <span class="cp">%&gt;</span><span class="x"></span>
</span><span class='line'><span class="x">&lt;/div&gt;</span>
</span></code></pre></td></tr></table></div></figure>


<p>You want to show a logout link while the user is signed in. However, when you pop the partial into the page, you get an error message:</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class='bash'><span class='line'>No route matches <span class="o">[</span>GET<span class="o">]</span> <span class="s2">&quot;/users/sign_out&quot;</span>
</span></code></pre></td></tr></table></div></figure>


<p>The problem is your logout link. By default, Devise sessions use <code>[DELETE] "/users/sign_out"</code> and not <code>[GET] "/users/sign_out"</code>. In general, HTTP <code>DELETE</code> is preferred over <code>GET</code>, since it demonstrates that you&rsquo;re trying to remove a resource (namely the user session).</p>

<p>To fix this, you need to provide the <code>method</code> parameter to <code>link_to</code>. The fix looks like this:</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
</pre></td><td class='code'><pre><code class='erb'><span class='line'><span class="x">&lt;div id=&quot;logout_link&quot;&gt;</span>
</span><span class='line'><span class="x">  </span><span class="cp">&lt;%</span> <span class="k">if</span> <span class="n">signed_in?</span> <span class="cp">%&gt;</span><span class="x"></span>
</span><span class='line'><span class="x">    </span><span class="cp">&lt;%=</span> <span class="n">link_to</span> <span class="s2">&quot;Logout&quot;</span><span class="p">,</span> <span class="n">destroy_user_session_path</span><span class="p">,</span> <span class="ss">:method</span> <span class="o">=&gt;</span> <span class="ss">:delete</span> <span class="cp">%&gt;</span><span class="x"></span>
</span><span class='line'><span class="x">  </span><span class="cp">&lt;%</span> <span class="k">end</span> <span class="cp">%&gt;</span><span class="x"></span>
</span><span class='line'><span class="x">&lt;/div&gt;</span>
</span></code></pre></td></tr></table></div></figure>


<p>You can read more about <code>link_to</code> <a href="http://farleyknight.github.io/rails-link_to/">here</a>.</p>

<p>Alternatively, although I would not recommend it, you can change the HTTP method used for signing out in <code>config/initializers/devise.rb</code>. That would mean changing this line:</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class='ruby'><span class='line'><span class="n">config</span><span class="o">.</span><span class="n">sign_out_via</span> <span class="o">=</span> <span class="ss">:delete</span>
</span></code></pre></td></tr></table></div></figure>


<p>to this</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class='ruby'><span class='line'><span class="n">config</span><span class="o">.</span><span class="n">sign_out_via</span> <span class="o">=</span> <span class="ss">:get</span>
</span></code></pre></td></tr></table></div></figure>


<p>I would only use this in situations where you have several logout links all over your app, or you can&rsquo;t change the logout link directly. It&rsquo;s really a bit of a hack that Devise was polite enough to provide for you through there configuration, and not something that&rsquo;s recommended on standard Rails apps.</p>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[Getting Started with Devise]]></title>
    <link href="http://farleyknight.github.io/getting-started-with-devise/"/>
    <updated>2013-09-02T12:17:00-04:00</updated>
    <id>http://farleyknight.github.io/getting-started-with-devise</id>
    <content type="html"><![CDATA[<h2>Before you dive in</h2>

<p><a href="https://github.com/plataformatec/devise">Devise</a> is a robust authentication framework for Rails. It covers 95% of the authentication use cases you&rsquo;ll ever have working with Rails. While it&rsquo;s very robust, that robustness comes at the cost of complexity. It is not recommended for absolute beginners. Moderate beginners, in other words, those of you who have used Rails for small projects and understand how authentication works in general, should try some sandbox projects with Devise.</p>

<p>However, if you&rsquo;re learning Ruby on Rails at the same time as programming in general, I would personally recommend that you wait until your 2nd or 3rd year of programming before you dive into Devise.</p>

<p>With that preface aside, if you feel confident enough for what&rsquo;s ahead, go ahead and start reading. If you find yourself confused or asking yourself questions about terms &amp; operations that I don&rsquo;t bother to explain, you should back up a bit and read my <a href="http://farleyknight.github.io/basic-rails-guide/">Basic Rails Guide</a>.</p>

<h2>Devise setup fast-track</h2>

<p>If you&rsquo;re looking to get set up immediately, without delay, you can create a fresh, new Rails app with this template:</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class='bash'><span class='line'>rails new my_website -m https://raw.github.com/farleyknight/rails_templates/master/devise.rb
</span></code></pre></td></tr></table></div></figure>


<p>If you&rsquo;re reading this tutorial slowly, to pick up on all the fine-grained details, you can use the template above to create an application to use as a reference as you read.</p>

<h2>Devise setup, step-by-Step</h2>

<p>The following will get you the very basics for working with Devise. As with most Rails gems, you&rsquo;ll want to add the following line to the bottom of your <code>Gemfile</code>.</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class='ruby'><span class='line'><span class="n">gem</span> <span class="s2">&quot;devise&quot;</span>
</span></code></pre></td></tr></table></div></figure>


<p>On the command line, run:</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class='bash'><span class='line'><span class="nv">$ </span>bundle install
</span></code></pre></td></tr></table></div></figure>


<p>In your Rails root directory. This will install Devise, and all it&rsquo;s dependencies. Once installed, run on the command line:</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class='bash'><span class='line'><span class="nv">$ </span>rails g devise:install
</span></code></pre></td></tr></table></div></figure>


<p>This adds <code>config/initializers/devise.rb</code> to your Rails project. I provide complete details on what this file does in the <a href="http://farleyknight.github.io/basic-devise-customization/">Basic Devise Customization</a>.</p>

<p>Come up with a descriptive name for the &ldquo;user&rdquo; object in your project. Something simple like <code>Account</code>, <code>Admin</code>, <code>Client</code>, or even just <code>User</code> is good enough for this tutorial. We&rsquo;ll assume that you&rsquo;re using <code>User</code> for the rest of this tutorial. Generate the <code>User</code> class by running:</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class='bash'><span class='line'><span class="nv">$ </span>rails g devise User
</span></code></pre></td></tr></table></div></figure>


<p>It should look like this:</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
</pre></td><td class='code'><pre><code class='ruby'><span class='line'><span class="k">class</span> <span class="nc">User</span> <span class="o">&lt;&lt;</span> <span class="ss">ActiveRecord</span><span class="p">:</span><span class="ss">:Base</span>
</span><span class='line'>  <span class="c1"># Include default devise modules. Others available are:</span>
</span><span class='line'>  <span class="c1"># :token_authenticatable, :confirmable,</span>
</span><span class='line'>  <span class="c1"># :lockable, :timeoutable and :omniauthable</span>
</span><span class='line'>  <span class="n">devise</span> <span class="ss">:database_authenticatable</span><span class="p">,</span> <span class="ss">:registerable</span><span class="p">,</span> <span class="ss">:recoverable</span><span class="p">,</span> <span class="ss">:rememberable</span><span class="p">,</span> <span class="ss">:trackable</span><span class="p">,</span> <span class="ss">:validatable</span>
</span><span class='line'><span class="k">end</span>
</span></code></pre></td></tr></table></div></figure>


<p>Each of those options to the <code>devise</code> method references a different devise module. That is covered in more detail in the <a href="http://farleyknight.github.io/basic-devise-guide/">Basic Devise Guide</a>. It also adds a database migration, found under <code>db/migrate/..._devise_create_users.rb</code>, which should look like this:</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
<span class='line-number'>25</span>
<span class='line-number'>26</span>
<span class='line-number'>27</span>
<span class='line-number'>28</span>
<span class='line-number'>29</span>
<span class='line-number'>30</span>
<span class='line-number'>31</span>
<span class='line-number'>32</span>
<span class='line-number'>33</span>
<span class='line-number'>34</span>
<span class='line-number'>35</span>
<span class='line-number'>36</span>
<span class='line-number'>37</span>
<span class='line-number'>38</span>
<span class='line-number'>39</span>
<span class='line-number'>40</span>
<span class='line-number'>41</span>
<span class='line-number'>42</span>
<span class='line-number'>43</span>
<span class='line-number'>44</span>
<span class='line-number'>45</span>
<span class='line-number'>46</span>
</pre></td><td class='code'><pre><code class='ruby'><span class='line'><span class="k">class</span> <span class="nc">DeviseCreateUsers</span> <span class="o">&lt;</span> <span class="ss">ActiveRecord</span><span class="p">:</span><span class="ss">:Migration</span>
</span><span class='line'>  <span class="k">def</span> <span class="nf">change</span>
</span><span class='line'>    <span class="n">create_table</span><span class="p">(</span><span class="ss">:users</span><span class="p">)</span> <span class="k">do</span> <span class="o">|</span><span class="n">t</span><span class="o">|</span>
</span><span class='line'>      <span class="c1">## Database authenticatable</span>
</span><span class='line'>      <span class="n">t</span><span class="o">.</span><span class="n">string</span> <span class="ss">:email</span><span class="p">,</span>              <span class="ss">:null</span> <span class="o">=&gt;</span> <span class="kp">false</span><span class="p">,</span> <span class="ss">:default</span> <span class="o">=&gt;</span> <span class="s2">&quot;&quot;</span>
</span><span class='line'>      <span class="n">t</span><span class="o">.</span><span class="n">string</span> <span class="ss">:encrypted_password</span><span class="p">,</span> <span class="ss">:null</span> <span class="o">=&gt;</span> <span class="kp">false</span><span class="p">,</span> <span class="ss">:default</span> <span class="o">=&gt;</span> <span class="s2">&quot;&quot;</span>
</span><span class='line'>
</span><span class='line'>      <span class="c1">## Recoverable</span>
</span><span class='line'>      <span class="n">t</span><span class="o">.</span><span class="n">string</span>   <span class="ss">:reset_password_token</span>
</span><span class='line'>      <span class="n">t</span><span class="o">.</span><span class="n">datetime</span> <span class="ss">:reset_password_sent_at</span>
</span><span class='line'>
</span><span class='line'>      <span class="c1">## Rememberable</span>
</span><span class='line'>      <span class="n">t</span><span class="o">.</span><span class="n">datetime</span> <span class="ss">:remember_created_at</span>
</span><span class='line'>
</span><span class='line'>      <span class="c1">## Trackable</span>
</span><span class='line'>      <span class="n">t</span><span class="o">.</span><span class="n">integer</span>  <span class="ss">:sign_in_count</span><span class="p">,</span> <span class="ss">:default</span> <span class="o">=&gt;</span> <span class="mi">0</span>
</span><span class='line'>      <span class="n">t</span><span class="o">.</span><span class="n">datetime</span> <span class="ss">:current_sign_in_at</span>
</span><span class='line'>      <span class="n">t</span><span class="o">.</span><span class="n">datetime</span> <span class="ss">:last_sign_in_at</span>
</span><span class='line'>      <span class="n">t</span><span class="o">.</span><span class="n">string</span>   <span class="ss">:current_sign_in_ip</span>
</span><span class='line'>      <span class="n">t</span><span class="o">.</span><span class="n">string</span>   <span class="ss">:last_sign_in_ip</span>
</span><span class='line'>
</span><span class='line'>      <span class="c1">## Confirmable</span>
</span><span class='line'>      <span class="c1"># t.string   :confirmation_token</span>
</span><span class='line'>      <span class="c1"># t.datetime :confirmed_at</span>
</span><span class='line'>      <span class="c1"># t.datetime :confirmation_sent_at</span>
</span><span class='line'>      <span class="c1"># t.string   :unconfirmed_email # Only if using reconfirmable</span>
</span><span class='line'>
</span><span class='line'>      <span class="c1">## Lockable</span>
</span><span class='line'>      <span class="c1"># t.integer  :failed_attempts, :default =&gt; 0 # Only if lock strategy is :failed_attempts</span>
</span><span class='line'>      <span class="c1"># t.string   :unlock_token # Only if unlock strategy is :email or :both</span>
</span><span class='line'>      <span class="c1"># t.datetime :locked_at</span>
</span><span class='line'>
</span><span class='line'>      <span class="c1">## Token authenticatable</span>
</span><span class='line'>      <span class="c1"># t.string :authentication_token</span>
</span><span class='line'>
</span><span class='line'>
</span><span class='line'>      <span class="n">t</span><span class="o">.</span><span class="n">timestamps</span>
</span><span class='line'>    <span class="k">end</span>
</span><span class='line'>
</span><span class='line'>    <span class="n">add_index</span> <span class="ss">:users</span><span class="p">,</span> <span class="ss">:email</span><span class="p">,</span>                <span class="ss">:unique</span> <span class="o">=&gt;</span> <span class="kp">true</span>
</span><span class='line'>    <span class="n">add_index</span> <span class="ss">:users</span><span class="p">,</span> <span class="ss">:reset_password_token</span><span class="p">,</span> <span class="ss">:unique</span> <span class="o">=&gt;</span> <span class="kp">true</span>
</span><span class='line'>    <span class="c1"># add_index :users, :confirmation_token,   :unique =&gt; true</span>
</span><span class='line'>    <span class="c1"># add_index :users, :unlock_token,         :unique =&gt; true</span>
</span><span class='line'>    <span class="c1"># add_index :users, :authentication_token, :unique =&gt; true</span>
</span><span class='line'>  <span class="k">end</span>
</span><span class='line'><span class="k">end</span>
</span></code></pre></td></tr></table></div></figure>


<p>After doing a migrate, run the <code>rake</code> command:</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class='bash'><span class='line'><span class="nv">$ </span>rake db:migrate
</span></code></pre></td></tr></table></div></figure>


<p>You should now have a <code>users</code> table in your database now. After that, you&rsquo;re pretty much good to go! Run</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class='bash'><span class='line'><span class="nv">$ </span>rails server
</span></code></pre></td></tr></table></div></figure>


<p>and you should be able to login at <code>http://localhost:3000/users/sign_up</code>.</p>

<h2>Handling Authentication</h2>

<p>It&rsquo;s not simply enough to allow users to log in to your site. You need to give your logged in users an incentive to log in! Here&rsquo;s how to set up your site to react differently, based on whether they&rsquo;ve logged in or not.</p>

<h3>Using login information in your views</h3>

<p>Most sites typically have a spot in the upper-right hand corner for logging into the site. For example, we might have a header toolbar, with the words &ldquo;Log into mysite.com&rdquo;. Similarly, after the user has logged in, that wording could change to say &ldquo;Logged in as: <a href="&#109;&#x61;&#105;&#x6c;&#116;&#x6f;&#58;&#102;&#97;&#x72;&#x6c;&#101;&#x79;&#x6b;&#110;&#105;&#x67;&#104;&#x74;&#64;&#103;&#x6d;&#97;&#105;&#108;&#x2e;&#99;&#x6f;&#x6d;">&#102;&#x61;&#x72;&#x6c;&#101;&#121;&#x6b;&#x6e;&#105;&#x67;&#104;&#116;&#64;&#103;&#x6d;&#x61;&#105;&#x6c;&#46;&#x63;&#x6f;&#x6d;</a>&rdquo;. Using the <code>user_logged_in?</code> and <code>current_user</code> methods, the code would look like this:</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
</pre></td><td class='code'><pre><code class='erb'><span class='line'><span class="cp">&lt;%</span> <span class="k">if</span> <span class="n">user_signed_in?</span> <span class="cp">%&gt;</span><span class="x"></span>
</span><span class='line'><span class="x">  Logged in as: </span><span class="cp">&lt;%=</span> <span class="n">current_user</span><span class="o">.</span><span class="n">email</span> <span class="cp">%&gt;</span><span class="x"></span>
</span><span class='line'><span class="cp">&lt;%</span> <span class="k">else</span> <span class="cp">%&gt;</span><span class="x"></span>
</span><span class='line'><span class="x">  </span><span class="cp">&lt;%=</span> <span class="n">link_to</span> <span class="s2">&quot;Log into mysite.com&quot;</span><span class="p">,</span> <span class="n">new_user_session_path</span> <span class="cp">%&gt;</span><span class="x"></span>
</span><span class='line'><span class="cp">&lt;%</span> <span class="k">end</span> <span class="cp">%&gt;</span><span class="x"></span>
</span></code></pre></td></tr></table></div></figure>


<h3>Checking if the user is logged in, per controller action</h3>

<p>Once you have basic authorization in place, you&rsquo;ll want to mark off sections of the site for logged-in users only. Let&rsquo;s say you have a <code>DashboardController</code> which is the dashboard for any logged in user. Using the before filter method <code>authenticate_user!</code>, we can be sure that this dashboard is only seen by logged in users.</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
</pre></td><td class='code'><pre><code class='ruby'><span class='line'><span class="k">class</span> <span class="nc">DashboardController</span> <span class="o">&lt;</span> <span class="no">ApplicationController</span>
</span><span class='line'>  <span class="n">before_filter</span> <span class="ss">:authenticate_user!</span>
</span><span class='line'>
</span><span class='line'>  <span class="k">def</span> <span class="nf">index</span>
</span><span class='line'>    <span class="c1"># Show some stuff to the logged-in user</span>
</span><span class='line'>  <span class="k">end</span>
</span><span class='line'><span class="k">end</span>
</span></code></pre></td></tr></table></div></figure>


<h3>User Redirection</h3>

<p>After your user has logged in, you want to redirect them to their dashboard. To do this, add the following method to your <code>ApplicationController</code>:</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
</pre></td><td class='code'><pre><code class='ruby'><span class='line'><span class="k">class</span> <span class="nc">ApplicationController</span> <span class="o">&lt;</span> <span class="ss">ActionController</span><span class="p">:</span><span class="ss">:Base</span>
</span><span class='line'>  <span class="c1"># ...</span>
</span><span class='line'>  <span class="k">def</span> <span class="nf">after_sign_in_path_for</span><span class="p">(</span><span class="n">user</span><span class="p">)</span>
</span><span class='line'>    <span class="n">dashboard_path</span>
</span><span class='line'>  <span class="k">end</span>
</span><span class='line'><span class="k">end</span>
</span></code></pre></td></tr></table></div></figure>


<p>After a user has logged out, you want to redirect them to a special page, thanking them and asking them to return soon. Here&rsquo;s another snippet you can use to do that:</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
</pre></td><td class='code'><pre><code class='ruby'><span class='line'><span class="k">class</span> <span class="nc">ApplicationController</span> <span class="o">&lt;</span> <span class="ss">ActionController</span><span class="p">:</span><span class="ss">:Base</span>
</span><span class='line'>  <span class="c1"># ...</span>
</span><span class='line'>  <span class="k">def</span> <span class="nf">after_sign_out_path_for</span><span class="p">(</span><span class="n">user</span><span class="p">)</span>
</span><span class='line'>    <span class="n">please_come_again_path</span>
</span><span class='line'>  <span class="k">end</span>
</span><span class='line'><span class="k">end</span>
</span></code></pre></td></tr></table></div></figure>


<h2>Further Setup</h2>

<p>If you need more control over how Devise works in your app, you&rsquo;re going to want to use their view generator as well. Run:</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class='bash'><span class='line'><span class="nv">$ </span>rails g devise:views
</span></code></pre></td></tr></table></div></figure>


<p>This adds a bunch of views under <code>app/views/devise/</code>. We can go into more detail under the <a href="http://farleyknight.github.io/basic-devise-customization/">Basic Devise Customization</a> guide.</p>

<p>Some other things you may want to do with your devise installation. You may want allow users to:</p>

<ul>
<li><a href="http://farleyknight.github.io/devise-edit-passwords/">Allow Users to edit their password</a></li>
<li><a href="http://farleyknight.github.io/devise-user-confirmation/">Confirm their accounts via email</a></li>
<li><a href="http://farleyknight.github.io/devise-user-invites/">Invite other users via email</a></li>
<li><a href="http://farleyknight.github.io/devise-cancan-rolify/">Advanced User authorization with CanCan and Rolify</a></li>
<li>Allow users to sign up via

<ul>
<li><a href="http://farleyknight.github.io/devise-facebook/">Facebook</a></li>
<li><a href="http://farleyknight.github.io/devise-twitter/">Twitter</a></li>
<li><a href="http://farleyknight.github.io/devise-google-plus/">Google+</a></li>
</ul>
</li>
</ul>


<p>Check out my full list of <a href="http://farleyknight.github.io/devise-tutorials/">my Devise tutorials</a> if you are stil curious.</p>
]]></content>
  </entry>
  
</feed>
